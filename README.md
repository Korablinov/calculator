# Calculator
## Для запуска локально, после того как скачали репозиторий и открыли в шторме, в терминале вводим вот эту команду `composer install`.
## Когда установка закончится, переходим в папку database/scripts и в алфавитном порядке запускаем файлы *.sql. 
## После этого в терминале вводим вот эту команду `php artisan server`
## Ссылка на ВМ
### проблемы с сервером.
## Task
#### Создать калькулятор для расчета ипотечного кредита, на основе информации о ипотеке (стоимость жилья, процентная ставка, и тд.). Операция расчета должна происходить в транзакции.Каждый фронтовой запрос логируется. Логи должны иметь уровни - debug, critical, warning. PHP код должен быть задокументирован (PHPDoc), а так же оформлен в PSR-12. Должна быть возможность скачать файлы с информацией о расчетах, и план-графики. В качестве БД использовать SQLite. Использовать PHP 7+. На клиентской части любой запрос происходит без перезагрузки страницы.

## Описание проекта
Проект делится на фронт и бэк. Оба проекта будут работать с использованием laravel.
Пользователь заполняет форму, некоторые поля динамически становятся заблокированными или устанавливаются в значения по умолчанию.

После того, как форма заполнена, данные отправляются на обработку, где в первую очередь проверяются на валидность,
в случае, если пользователь ввел что-то неверно — возвращается массив с ошибками и выводится на экран,
если форма заполнена верно, производится расчет ипотеки, создание pdf и xlsx файлов, которые пользователь может
скачать при нажатии на соответствующие кнопки.

Банки дают под разные проценты ипотеку, в формуле для расчета некоторые значения
индивидуальны.

Для ипотеки вычисляются следующие данные:
#### 1.Ежемесячный платеж = Сумма кредита * Ежемесячная ставка * Общая ставка / (Общая ставка -1)
Где: 
##### Сумма кредита = Стоимость недвижимости - Первоначальный взнос
##### Ежемесячная ставка = Процентная ставка годовых / 12 /100)
##### Общая ставка = (1 + Ежемесячна ставка)^ Срок ипотеки (месяцев)
#### 2 Процентная часть = Остаток долга * Ежемесячная ставка
Где:
##### Остаток долга = в первый месяц равен Сумме кредита, каждый месяц отнимается ежемесячный платеж
##### Основная часть = Ежемесячный платеж - Процентная часть
##### Переплата = Ежемесячный платеж * Срок ипотеки (месяцев) - Сумма кредита


Пользователь может вводить даже самые неадекватные данные, например стоимость недвижимости в 1 рубль, проверки на минимальные
значения входных данных нет, главное, чтобы они не были равны нулю в некоторых полях, оно все равно посчитает ипотеку.
***
### Описание структуры проекта

- **task_inter-korablinov_calculator** - корневая папка.
    - **app**
          - **Http**
                - **Controllers** - папка, содержащая файлы, которые обрабатывают пользовательские запросы        
                    - **Calculator.php** - скрипт, в котором содержится основная логика расчетов ипотеки, проверка папки с
                временными файлами, создание PDF и XLSX файлов, валидация входных данных.
                    - **CreatePdf.php** - файл, отвечающий за создание PDF файлов.
                    - **CreateXlsx.php** - файл, отвечающий за создание XLSX файлов.
    - **database**
          - **scripts** - папка с sql скриптами для создания таблиц БД и заполнения их данными.
              - **createTables.sql** -скрипт, создающий таблицы с банками и ипотеками
              - **insertData.sql** - скрипт, заполняющий таблицы с банками и ипотеками данными
    - **resources**
      - **views**  - папка с фронтенд проектом.       
        - **index.blade.php** - скрипт, отвечающий за принятие данных с клиентской стороны,отправку их на бекенд и возврат соответствующих результатов средствами библиотеки vue.js без перезагрузки страницы.
        - **createXlsx.blade.php** - используется для создания xlsx таблицы
    - **routes** - папка с роутами
      - **web.php** - все роуты проекта
    - **storage** 
      - **app**
        - **temp** - папка с временными XLSX файлами
          -  **\*.xlsx** - xlsx файлы.
      - **logs** - папка с логами
        - **laravel.log** - главный лог проекта, в нем содержатся все ошибки уведомления и информация для отладки.
      - **temp** - папка с временными PDF файлами пользователей.
          - **\*.pdf** - pdf файлы.
***
### Ссылка на приложение в ВМ

### Frontend
Со стороны фронта выступает приложение на фреймворке Vue.js.
Он будет использовать библиотеку Axios для формирования API-запросов. Есть валидация.
Стилизация будет происходить при помощи css фреймворка Bootstrap.

### Backend
Со стороны бэкенда будет выступать приложение на фреймворке Laravel. Роутинг, валидация, формирование структуры БД,
транзакции и логирование реализуются уже готовыми механизмами фрейморка. Для формирования План-графика ипотечного кредита (PDF файл)
используется библиотека dompdf/dompdf. Для формирования План-графика (Xlsx таблицы) используется библиотека maatwebsite/excel.


## Ограничения
### 1.Для решения использовался php 7.4.
### 2.Для запуска API в системе пользователя должен быть установлен php 
#### 3.Перед запуском необходимо установить зависимости с использованием Composer
